{"version":3,"sources":["webpack:///webpack/bootstrap 8771bee1e6014a9d77e5","webpack:///./~/babel-runtime/regenerator/index.js","webpack:///external \"lodash\"","webpack:///./server/config.js","webpack:///./server/common/error.js","webpack:///external \"joi\"","webpack:///external \"sequelize\"","webpack:///external \"koa\"","webpack:///./common/api/gitlab.js","webpack:///./server/models/dataSource.js","webpack:///./server/models/database.js","webpack:///./server/models/user.js","webpack:///external \"jwt-simple\"","webpack:///external \"wurl\"","webpack:///./nuxt.config.js","webpack:///./server/server.js","webpack:///external \"nuxt\"","webpack:///./common/api/elasticSearch.js","webpack:///./common/config.js","webpack:///./server/controllers/dataSource.js","webpack:///./server/controllers/gitlab.js","webpack:///./server/controllers/index.js","webpack:///./server/controllers/user.js","webpack:///./server/middlewares/index.js","webpack:///./server/middlewares/validate.js","webpack:///./server/models/index.js","webpack:///./server/prod.config.js","webpack:///external \"@koa/cors\"","webpack:///external \"elasticsearch\"","webpack:///external \"js-base64\"","webpack:///external \"js-yaml\"","webpack:///external \"koa-body\"","webpack:///external \"koa-jwt\"","webpack:///external \"koa-router\"","webpack:///external \"koa-static\"","webpack:///external \"path\"","webpack:///external \"regenerator-runtime\"","webpack:///external \"webpack\"","webpack:///./server/index.js","webpack:///external \"node-gitlab-api\""],"names":["defaultConfig","gitlabToken","secret","database","host","type","username","password","productionConfig","developmentConfig","configs","Err","code","message","data","prototype","setMessage","setCode","setData","ERR","ERR_OK","ERR_PARAMS","ERR_UNATUH","ERR_NOT_FOUND","defaultUsername","apiBaseUrl","rawBaseUrl","token","ref","branch","projectId","xiaoyaoConfig","externalUsername","projectName","keepworkConfig","gitlab","gits","encodeUrl","url","encodeURIComponent","replace","getUsernameByPath","path","paths","split","i","length","Gitlab","config","_","mapKeys","value","key","camelCase","cfg","gitcfg","api","getFile","RepositoryFiles","show","then","file","content","Base64","decode","getContent","upsertFile","options","editFile","createFile","edit","create","removeFile","remove","getTree","Repositories","tree","getFileGitUrl","initConfig","getGitByPath","git","gitlabFactory","DataSource","sequelize","define","id","Sequelize","BIGINT","autoIncrement","primaryKey","STRING","allowNull","name","unique","externalUserId","externalPassword","isDefault","BOOLEAN","dbconfig","dialect","operatorsAliases","pool","max","min","acquire","idle","User","set","val","setDataValue","toUpperCase","email","cellphone","nickname","portrait","sex","require","webpack","console","log","resolve","module","exports","srcDir","performance","prefetch","plugins","src","ssr","head","title","meta","charset","hid","link","rel","href","css","loading","color","build","analyze","vendor","babel","libraryName","styleLibraryName","extend","ctx","entry","optimize","CommonsChunkPlugin","names","minChunks","Infinity","alias","node","fs","tls","net","apiRouter","prefix","apiUrlPrefix","registerControllerRouter","app","views","viewRouter","use","Static","cors","KoaBody","jwt","passthrough","cookie","routes","allowedMethods","client","elasticsearch","Client","elasticsearchFactory","urlPrefix","pageSuffix","tagModsPath","port","baseURL","defaultDataSource","model","update","delete","find","getSystemDataSource","cloneDeep","getDefaultDataSource","params","request","query","authUsername","state","user","findOne","where","dataSource","get","plain","undefined","getRoutes","method","action","getGitData","JSON","parse","formatSiteinfoESData","formatUserinfoESData","formatPageinfoESData","formatESDataMap","getGitFileData","yaml","safeLoad","json","e","formatESData","tablename","format","submitESData","item","indexs","index_prefix","version","esData","index","join","body","res","esClient","webhook","self","commit","commits","project_url","project","http_url","origin","wurl","project_id","external_username","user_username","filelist","dataFileReg","filelistAddItem","oper","test","match","push","each","added","modified","removed","promises","Promise","all","controllers","router","ctrl","route","methods","isArray","lowerCase","validate","next","requireAuth","status","register","encode","userId","_id","userinfo","login","isLogin","findById","joi","string","required","schema","opt","defaultsDeep","allowUnknown","defaultValidateKeys","needValidateKeys","intersection","Object","keys","errors","toValidateObj","result","error","details","assignIn","msg","dev","env","nuxt","builder","server","reject","on","req","render","promise","catch","_config","listen","start"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 50);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8771bee1e6014a9d77e5","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/regenerator/index.js\n// module id = 0\n// module chunks = 0","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 1\n// module chunks = 0","import commonConfig from \"../common/config.js\";\nimport config from \"./prod.config.js\";\n\nconst defaultConfig = {\n\t...commonConfig,\n\n\tgitlabToken: \"18ayouuEsKRo_yM1P5eF\",\n\n\tsecret: \"keepwork\",\n\n\tdatabase: {\n\t\t//port:3306,\n\t\thost: '39.106.11.114',\n\t\ttype: \"mysql\",\n\t\tdatabase: \"keepwork\", // 数据库名\n\t\tusername: \"wuxiangan\",\n\t\tpassword: \"xxxxxx\", \n\t},\n}\n\nconst productionConfig = {\n\t...defaultConfig,\n\t\n\t...config,\n}\n\nconst developmentConfig = {\n\t...defaultConfig,\n\n\t...config,\n}\n\nconst configs = {\n\t\"production\": productionConfig,\n\t\"development\": developmentConfig,\n}\n\nexport default configs[process.env.NODE_ENV];\n\n\n\n// WEBPACK FOOTER //\n// ./server/config.js","\nexport const Err = function(code, message, data) {\n\tthis.code = code || 0;\n\tthis.message = message || \"OK\";\n\tthis.data = data || null; // 请求数据\n}\n\nErr.prototype.setMessage = function(message = \"OK\"){\n\tthis.message = message;\n\treturn this;\n}\n\nErr.prototype.setCode = function(code = 0){\n\tthis.code = code; \n\treturn this;\n}\n\nErr.prototype.setData = function(data){\n\tthis.data = data;\n\treturn this;\n}\n\nexport const ERR = new Err(-1, \"unknown error\");\nexport const ERR_OK = new Err();\nexport const ERR_PARAMS = new Err(1, \"参数错误\");\nexport const ERR_UNATUH = new Err(2, \"未认证\");\nexport const ERR_NOT_FOUND = new Err(3, \"未找到记录\");\n\nexport default {\n\tERR,\n\tERR_OK,\n\tERR_PARAMS,\n\tERR_UNATUH,\n\tERR_NOT_FOUND,\n};\n\n\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./server/common/error.js","module.exports = require(\"joi\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"joi\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"koa\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa\"\n// module id = 7\n// module chunks = 0","//import gitlabApi from \"../../client/lib/gitlab-api\";\nimport gitlabApi from \"node-gitlab-api\";\nimport {Base64} from \"js-base64\";\nimport _ from \"lodash\";\n\n\nconst defaultUsername = \"keepwork\";\n\nconst defaultConfig = {\n\tapiBaseUrl:\"https://gitlab.com\",\n\trawBaseUrl:\"https://gitlab.com\",\n\ttoken:\"Ed9S7hSfiruewMR-jitR\",\n\tref:\"master\",\n\tbranch:\"master\",\n\tprojectId:4980659,\n\t//rootPath:\"xiaoyao\",\n};\n\nconst xiaoyaoConfig = {\n\tusername:\"xiaoyao\",\n\tprojectId: 4980659,\n\texternalUsername: \"wxaxiaoyao\",\n\tprojectName: \"keepworkdatasource\",\n\ttoken:\"Ed9S7hSfiruewMR-jitR\",\n\tref: \"master\",\n\tbranch: \"master\",\n}\n\nconst keepworkConfig = {\n\tusername:\"keepwork\",\n\texternalUsername: \"keepwork\",\n\tprojectName: \"keepworkdatasource\",\n\thost:\"https://gitlab.com\",\n\ttoken:\"9x94xLa-CZPH9Da5h5kd\",\n\tref:\"master\",\n\tbranch: \"master\",\n\tprojectId:5112836,\n}\n\nconst gitlab = {\n\tgits:{\n\n\t}\n}\n\nconst encodeUrl = function(url) {\n\treturn encodeURIComponent(url).replace(/\\./g,'%2E')\n}\n\nconst getUsernameByPath = function(path) {\n\tconst paths = (path || \"\").split(\"/\");\n\tlet username = \"keepwork\";\n\tfor (let i = 0; i < paths.length; i++) {\n\t\tif (paths[i]) {\n\t\t\tusername = paths[i];\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tusername = username.replace(/_(data|files)$/, \"\");\n\n\treturn username;\n}\n\nfunction Gitlab(config){\n\tconfig = _.mapKeys(config || {}, (value, key) => _.camelCase(key));\n\tthis.cfg = {\n\t\t...defaultConfig,\n\t\t...((gitlab.gits[config.username] || {}).cfg || {}),\n\t\t...(config || {}),\n\t};\n\t//console.log(cfg);\n\t\n\tconst gitcfg = {url: this.cfg.rawBaseUrl, token: this.cfg.token};\n\t//this.api = {\n\t\t////RepositoryFiles: new RepositoryFiles(gitcfg),\n\t\t////Repositories: new Repositories(gitcfg),\n\t//}\n\tthis.api = new gitlabApi({url:this.cfg.rawBaseUrl, token:this.cfg.token});\n\t//return this;\n}\n\nGitlab.prototype.getFile = function(path) {\n\treturn this.api.RepositoryFiles.show(this.cfg.projectId, path, this.cfg.ref).then(file => {\n\t\tfile.content = Base64.decode(file.content);\n\t\treturn file;\n\t});\n}\n\nGitlab.prototype.getContent = function(path) {\n\treturn this.api.RepositoryFiles.show(this.cfg.projectId, path, this.cfg.ref).then(file => Base64.decode(file.content));\n}\n\nGitlab.prototype.upsertFile = function(path, options) {\n\tconst file = this.getFile(path);\n\treturn file ? this.editFile(path, options) : this.createFile(path, options);\n}\n\nGitlab.prototype.editFile = function(path, options) {\n\treturn this.api.RepositoryFiles.edit(this.cfg.projectId, path, this.cfg.branch, options);\n}\n\nGitlab.prototype.createFile = function(path, options) {\n\treturn this.api.RepositoryFiles.create(this.cfg.projectId, path, this.cfg.branch, options);\n}\n\nGitlab.prototype.removeFile = function(path, options) {\n\treturn this.api.RepositoryFiles.remove(this.cfg.projectId, path, this.cfg.branch, options);\n}\n\nGitlab.prototype.getTree = function(path, options) {\n\toptions = options || {};\n\toptions.path = path;\n\n\treturn this.api.Repositories.tree(this.cfg.projectId, options);\n}\n\nGitlab.prototype.getFileGitUrl = function(path) {\n\tconst url = this.cfg.rawBaseUrl + \"/\" + this.cfg.externalUsername + \"/\" + this.cfg.projectName + '/blob/' + \"master\" + '/' + path;\n\t\n\treturn url;\n}\n\ngitlab.initConfig = function(config){\n\tif (!config || !config.username) {\n\t\treturn;\n\t}\n\t\n\tthis.gits[config.username] = new Gitlab(config);\n}\n\ngitlab.getGitByPath = function(path) {\n\tconst username = getUsernameByPath(path);\n\treturn this.gits[username] || this.gits[defaultUsername];\n}\n\ngitlab.getContent = function(path) {\n\treturn this.getGitByPath(path).getContent(path);\n}\n\ngitlab.getFile = function(path) {\n\treturn this.getGitByPath(path).getFile(path);\n}\n\ngitlab.editFile = function(path, options) {\n\tconst git = this.getGitByPath(path);\n\treturn git.editFile(path, options);\n}\n\ngitlab.createFile = function(path, options) {\n\tconst git = this.getGitByPath(path);\n\t//path = encodeUrl(path);\n\treturn git.createFile(path, options);\n}\n\ngitlab.removeFile = function(path, options) {\n\tconst git = this.getGitByPath(path);\n\treturn git.removeFile(path, options);\n}\n\ngitlab.getTree = function(path, options) {\n\tconst git = this.getGitByPath(path);\n\treturn git.getTree(path, options);\n}\n\ngitlab.getFileGitUrl = function(path) {\n\treturn this.getGitByPath(path).getFileGitUrl(path);\n}\n\ngitlab.initConfig(keepworkConfig);\ngitlab.initConfig(xiaoyaoConfig);\n\nexport const gitlabFactory = (config) => new Gitlab(config);\nexport default gitlab;\n\n\n\n// WEBPACK FOOTER //\n// ./common/api/gitlab.js","import Sequelize from 'sequelize';\nimport sequelize from \"./database.js\";\n\nconst DataSource = sequelize.define(\"dataSource\", {\n\tid: {\n\t\ttype: Sequelize.BIGINT,\n\t\tautoIncrement: true,\n\t\tprimaryKey: true,\n\t},\n\n\tusername: {\n\t\ttype: Sequelize.STRING(48),\n\t\tallowNull: false,\n\t},\n\n\tname: {\n\t\ttype: Sequelize.STRING(48),\n\t\tunique: true,\n\t},\n\n\ttype: {\n\t\ttype: Sequelize.STRING(12),\n\t},\n\n\ttoken: {\n\t\ttype: Sequelize.STRING(128),\n\t\t//allowNull, false,\n\t},\n\n\tapiBaseUrl: {\n\t\ttype: Sequelize.STRING(64),\n\t},\n\n\trawBaseUrl: {\n\t\ttype: Sequelize.STRING(64),\n\t},\n\n\texternalUserId: {\n\t\ttype: Sequelize.BIGINT,\n\t},\n\n\texternalUsername: {\n\t\ttype: Sequelize.STRING(48),\n\t},\n\n\texternalPassword: {\n\t\ttype: Sequelize.STRING(128),\n\t},\n\t\n\tisDefault: {\n\t\ttype: Sequelize.BOOLEAN,\n\t},\n});\n\n//DataSource.sync({force:true}).then(() => {\n\t//console.log(\"create dataSource table successfully\");\n//});\n\nexport default DataSource;\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/dataSource.js","import Sequelize from 'sequelize';\nimport config from \"../config.js\";\n\nconst dbconfig = config.database;\n\nconst sequelize = new Sequelize(dbconfig.database, dbconfig.username, dbconfig.password, {\n  host: dbconfig.host,\n  dialect: dbconfig.type,\n  operatorsAliases: false,\n\n  pool: {\n    max: 5,\n    min: 0,\n    acquire: 30000,\n    idle: 10000\n  },\n\n  // SQLite only\n  //storage: 'path/to/database.sqlite'\n});\n\n//sequelize\n  //.authenticate()\n  //.then(() => {\n    //console.log('Connection has been established successfully.');\n  //})\n  //.catch(err => {\n    //console.error('Unable to connect to the database:', err);\n  //});\n\nexport default sequelize;\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/database.js","import Sequelize from 'sequelize';\nimport sequelize from \"./database.js\";\n\nconst User = sequelize.define('user', {\n\tid: {\n\t\ttype: Sequelize.BIGINT,\n\t\tautoIncrement: true,\n\t\tprimaryKey: true,\n\t},\n\t\n\tusername: {\n\t\ttype: Sequelize.STRING(48),\n\t\tunique: true,\n\t},\n\n\tpassword: {\n\t\ttype: Sequelize.STRING(48),\n\n\t\tset(val) {\n\t\t\tthis.setDataValue(\"password\", val.toUpperCase());\n\t\t},\n\t},\n\n\temail: {\n\t\ttype: Sequelize.STRING(24),\n\t\tunique: true,\n\t},\n\n\tcellphone: {\n\t\ttype: Sequelize.STRING(24),\n\t\tunique: true,\n\t},\n\n\tnickname: {\n\t\ttype: Sequelize.STRING,\n\t},\n\n\tportrait: {\n\t\ttype: Sequelize.STRING,\n\t},\n\n\tsex: {\n\t\ttype: Sequelize.STRING(4),\n\t},\n});\n\n//User.sync({force:true}).then(() => {\n\t//console.log(\"create user table successfully\");\n//});\n\n\nexport default User;\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/user.js","module.exports = require(\"jwt-simple\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jwt-simple\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"wurl\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"wurl\"\n// module id = 15\n// module chunks = 0","const path = require(\"path\");\nconst webpack = require(\"webpack\");\n\nconsole.log(path.resolve(\".\"));\nmodule.exports = {\n\tsrcDir: \"client/\",\n\n\tperformance: {\n\t\tprefetch: false,\n\t},\n\n\tplugins: [\n\t{src:\"~/plugins/app\", ssr: false},\n\t{src:\"~/plugins/persistedstate\", ssr: false},\n\t{src:\"~/plugins/codemirror\", ssr: false},\n\t//{src:\"~/plugins/element-ui\"},\n\t//{src:\"~/plugins/test\", ssr: false},\n\t],\n\n\t/*\n  \t** Headers of the page\n  \t*/\n  \thead: {\n\t\ttitle: 'starter',\n  \t  \tmeta: [\n\t\t\t{ charset: 'utf-8' },\n  \t  \t  \t{ name: 'viewport', content: 'width=device-width, initial-scale=1' },\n  \t  \t  \t{ hid: 'description', name: 'description', content: 'Nuxt.js project' }\n  \t  \t],\n  \t  \tlink: [\n\t\t\t{ rel: 'icon', type: 'image/x-icon', href: '/favicon.ico' }\n  \t  \t]\n  \t},\n  \t/*\n  \t** Global CSS\n  \t*/\n  \tcss: [\n\t\t'font-awesome/css/font-awesome.min.css',\n\t\t'~assets/css/main.css'\n\t],\n  \t/*\n  \t** Customize the progress-bar color\n  \t*/\n  \tloading: { color: '#3B8070' },\n  \t/*\n  \t ** Build configuration\n  \t */\n  \tbuild: {\n\t\tanalyze: true,\n\t\tvendor: [\n\t\t\t\"lodash\",\n\t\t\t\"axios\",\n\t\t\t\"vuex-persistedstate\",\n\t\t],\n\t\tbabel: {\n\t\t\t//presets:[\n\t\t\t//],\n\t\t\tplugins:[\n\t\t\t\t\"syntax-dynamic-import\",\n\t\t\t\t[\n\t\t\t\t\t\"component\",\n\t\t\t\t\t{\n\t\t\t\t\t\tlibraryName:\"element-ui\",\n\t\t\t\t\t\tstyleLibraryName:\"theme-chalk\",\n\t\t\t\t\t},\n\t\t\t\t\t'transform-async-to-generator',\n\t\t\t\t\t'transform-runtime',\n\t\t\t\t],\n\t\t\t],\n\t\t},\n  \t  \textend (config, ctx) {\n\t\t\tif (config.name == \"server\") {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconfig.entry[\"vendor1\"] = [\"~/plugins/codemirror\", \"node-gitlab-api\"];\n\t\t\tconfig.plugins[0] = new webpack.optimize.CommonsChunkPlugin({\n\t\t\t\t//name:\"vendor\",\n\t\t\t\tnames: [\"vendor1\", \"vendor\"],\n\t\t\t\t//chunks: [\"lodash\", \"axios\"],\n\t\t\t\tminChunks: Infinity,\n\t\t\t});\n\n\t\t\tconfig.resolve.alias[\"vue$\"] = \"vue/dist/vue.esm.js\";\n\t\t\t//config.resolve.alias[\"gitlabapi$\"] = \"~/lib/gitlab-api/index.js\";\n\t\t\t//console.log(config.resolve.alias);\n\t\t\tconfig.node = {\n\t\t\t\t...(config.node || {}),\n\t\t\t\tfs: \"empty\",\n\t\t\t\ttls: \"empty\",\n  \t  \t\t\tnet: \"empty\",\n  \t  \t\t};\n  \t  \t}\n  \t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","import Koa from \"koa\";\nimport cors from \"@koa/cors\";\nimport jwt from \"koa-jwt\";\nimport Router from \"koa-router\";\nimport KoaBody from \"koa-body\";\nimport Static from \"koa-static\";\nimport wurl from \"wurl\";\nimport _ from \"lodash\";\n\nimport registerControllerRouter from \"./controllers/index.js\";\n\n//import log from \"./log.js\";\nimport config from \"./config.js\";\nimport models from \"./models/index.js\";\n\nconst apiRouter = new Router({\n\tprefix: config.apiUrlPrefix,\n});\nregisterControllerRouter(apiRouter);\n\n\nexport default (app, views) => {\n\tconst viewRouter = new Router({});\n\t//viewRouter.get(\"/www/*\", views);\n\n\tapp\n\t.use(Static(\"../.nuxt/\"))\n\t.use(cors())\n\t.use(KoaBody())\n\t.use(jwt({secret:config.secret, passthrough:true, cookie:\"token\"}))\n\t.use(apiRouter.routes())\n\t.use(apiRouter.allowedMethods())\n\t.use(viewRouter.routes());\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./server/server.js","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 18\n// module chunks = 0","\nimport elasticsearch from \"elasticsearch\";\n\nconst defaultConfig = {\n\thost: \"http://10.28.18.7:9200\",\n}\n\nconst client = new elasticsearch.Client({\n\t...defaultConfig,\n});\n\nexport const elasticsearchFactory = (config) => {\n\treturn new elasticsearch.Client({\n\t\t...defaultConfig,\n\t\t...(config || {}),\n\t});\n}\n\nexport default client;\n\n\n\n// WEBPACK FOOTER //\n// ./common/api/elasticSearch.js","\nconst config = {\n\turlPrefix: \"wiki\",\n\tapiUrlPrefix: \"/api/v0\",\n\tpageSuffix:\".md\",\n\ttagModsPath: \"keepwork_data/tag_mods.json\",\n\n\thost: \"127.0.0.1\",\n\tport: 3000,\n}\n\nconfig.baseURL = \"http://\" + config.host + \":\" + config.port + config.apiUrlPrefix;\n\nexport default config;\n\n\n\n// WEBPACK FOOTER //\n// ./common/config.js","import _ from \"lodash\";\nimport joi from \"joi\";\nimport jwt from \"jwt-simple\";\n\nimport config from \"../config.js\";\nimport ERR from \"../common/error.js\";\nimport DataSourceModel from \"../models/dataSource.js\";\n\nconst defaultDataSource = {\n\tusername:\"keepwork\",\n\texternalUsername: \"keepwork\",\n\tprojectName: \"keepworkdatasource\",\n\thost:\"https://gitlab.com\",\n\ttoken:\"9x94xLa-CZPH9Da5h5kd\",\n\tref:\"master\",\n\tbranch: \"master\",\n\tprojectId:5112836,\n}\n\nexport const DataSource = function() {\n\tthis.model = DataSourceModel;\n}\n\nDataSource.prototype.create = function() {\n\n} \n\nDataSource.prototype.update = function() {\n\n}\n\nDataSource.prototype.delete = function() {\n\n}\n\nDataSource.prototype.find = function() {\n\n}\n\nDataSource.prototype.getSystemDataSource = function() {\n\treturn _.cloneDeep(defaultDataSource);\n}\n\n// 获取用户默认数据源\nDataSource.prototype.getDefaultDataSource = async function(ctx) {\n\tconst params = ctx.request.query;\n\tconst authUsername = ctx.state.user.username;\n\tconst username = params.username || authUsername;\n\n\tif (!username) return ERR.ERR_PARAMS;\n\t\n\tlet dataSource = await this.model.findOne({\n\t\twhere: {\n\t\t\tusername: username,\n\t\t\tisDefault: true,\n\t\t},\n\t});\n\n\tif (!dataSource) return ERR.ERR_NOT_FOUND;\n\n\tdataSource = dataSource.get({plain:true});\n\n\tif (username != authUsername) {\n\t\tdataSource.token = undefined;\n\t\tdataSource.externalPassword = undefined;\n\t}\n\n\treturn dataSource;\n}\n\nDataSource.prototype.getRoutes = function() {\n\tconst prefix = \"/dataSource\";\n\tconst routes = [\n\t{\n\t\tpath: prefix + \"/getDefaultDataSource\",\n\t\tmethod: \"get\",\n\t\taction: \"getDefaultDataSource\",\n\t},\n\t];\n\n\treturn routes;\n}\n\nexport default new DataSource();\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/dataSource.js","import _ from \"lodash\";\nimport joi from \"joi\";\nimport wurl from \"wurl\";\nimport yaml from \"js-yaml\";\n\nimport ERR from \"../common/error.js\";\nimport config from \"../config.js\";\nimport esClient from \"../../common/api/elasticSearch.js\";\nimport {gitlabFactory} from \"../../common//api/gitlab.js\";\nimport gitlab from \"../../common/api/gitlab.js\";\n//import {gitlabFactory} from \"../../vue/src//api/gitlab.js\";\n\n// 获取GIT的ES数据\nconst getGitData = async function(git, path) {\n\ttry {\n\t\tconst content = await git.getContent(path);\n\t\tconst data = JSON.parse(content);\n\t\treturn data;\n\t} catch (e){\n\t\tconsole.log(e);\n\t}\n\treturn;\n} \n\nconst formatSiteinfoESData = function(data) {\n\n}\n\nconst formatUserinfoESData = function(data) {\n\n}\n\nconst formatPageinfoESData = function(data) {\n\n}\n\nconst formatESDataMap = {\n\t\"userinfo\": formatUserinfoESData,\n\t\"siteinfo\": formatSiteinfoESData,\n\t\"pageinfo\": formatPageinfoESData,\n}\n\nexport const Gitlab = function() {\n\t\n}\n\n// 获取git文件中的数据信息\nGitlab.prototype.getGitFileData = function(content) {\n\ttry {\n\t\t//return Json.parse(content);\n\t\treturn yaml.safeLoad(content, {json:true});\n\t} catch(e) {\n\t\tconsole.log(e);\n\t}\n\n\treturn ;\n}\n\nGitlab.prototype.formatESData = function(data, tablename) {\n\tdata = _.cloneDeep(data || {});\n\tconst format = formatESDataMap[tablename];\n\n\tformat && format(data);\n\n\treturn data;\n}\n\nGitlab.prototype.submitESData = async function(item) {\n\tconst data = item.data || {};\n\tconst tablename = item.tablename;\n\tconst path = item.path;\n\tconst action = item.action;\n\tconst indexs = [data.index_prefix || \"kw\", tablename, data.version || \"v0\"];\n\tconst esData = {\n\t\tindex: indexs.join(\"_\"),\n\t\ttype: tablename,\n\t\tid: path.replace(/\\//g, \"_\"),\n\t\tbody: data.data || {},\n\t}\n\tesData.body.path = path;\n\n\tlet res = null;\n\ttry {\n\t\t//console.log(item, esData);\n\t\tres = await (esClient[action])(esData);\n\t} catch(e) {\n\t\tconsole.log(e);\n\t}\n\t//console.log(res);\n}\n\nGitlab.prototype.webhook = async function(ctx) {\n\tconst self = this;\n\tconst params = ctx.request.body;\n\tconst commit = params.commits[0];\n\tconst project_url = params.project.http_url;\n\tconst origin = wurl(\"protocol\", project_url) + \"://\" + wurl(\"hostname\", project_url);\n\tconst gitcfg = {\n\t\trawBaseUrl:origin,\n\t\tproject_id:params.project_id,\n\t\texternal_username: params.user_username,\n\t\tusername:\"xiaoyao\",\t\n\t\ttoken:config.gitlabToken,\n\t}\n\tconst git = gitlabFactory(gitcfg);\n\t\n\t// 取出文件列表\n\tconst filelist = [];\n\tconst dataFileReg = /^[\\w\\d]+_data\\/([_\\w]+)\\/.+\\.yaml$/;\n\tconst filelistAddItem = (path, oper, action) => {\n\t\tif (!dataFileReg.test(path)) return;\n\t\t\n\t\tconst tablename = path.match(dataFileReg)[1];\n\t\t\n\t\tfilelist.push({\n\t\t\tpath:path, \n\t\t\ttablename:tablename,\n\t\t\toper:oper,\n\t\t\taction:action,\n\t\t});\n\t}\n\n\t_.each(params.commits, commit => {\n\t\t_.each(commit.added, (path) => filelistAddItem(path, \"added\", \"index\"));\n\t\t_.each(commit.modified, (path) => filelistAddItem(path, \"modified\", \"index\"));\n\t\t_.each(commit.removed, (path) => filelistAddItem(path, \"removed\", \"delete\"));\n\t});\n\n\tconst promises = [];\n\t_.each(filelist, (item) => {\n\t\tpromises.push(git.getContent(item.path).then(content => {\n\t\t\titem.content = content;\n\t\t\titem.data = self.getGitFileData(content) || {};\n\t\t\t//console.log(item);\n\t\t\t//item.esData = self.formatESData(item.data),\n\t\t}));\n\t});\n\n\tawait Promise.all(promises);\n\n\t//console.log(filelist);\n\t_.each(filelist, file => self.submitESData(file));\n\n\treturn ;\n}\n\n// 提供接口 写git es\nGitlab.prototype.gitlab = async (ctx) => {\n\tconst params = ctx.request.body;\n\n\tif (!params.git || !params.git.projectId || !params.path || !params.data) return ERR.ERR_PARAMS;\n\n\tconst gitcfg = params.git;\n\tgitcfg.token = gitcfg.token || config.gitlabToken;\n\tconst git = gitlabFactory(gitcfg);\n\n\tgit.upsertFile();\n}\n\nGitlab.prototype.getRoutes = function() {\n\tconst prefix = \"/gitlab\";\n\tconst routes = [\n\t{\n\t\tpath: prefix + \"/webhook\",\n\t\tmethod: \"post\",\n\t\taction: \"webhook\",\n\t},\n\t];\n\n\treturn routes;\n}\n\nexport default new Gitlab();\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/gitlab.js","import _ from \"lodash\";\nimport {validate} from \"../middlewares/index.js\";\n\nimport {ERR_UNATUH} from \"../common/error.js\";\n\nimport user from \"./user.js\";\nimport dataSource from \"./dataSource.js\";\nimport gitlab from \"./gitlab.js\"; \n\nexport const controllers = {\n\tuser,\n\tdataSource,\n\tgitlab,\n}\n\nexport const registerControllerRouter = function(router) {\n\t_.each(controllers, ctrl => {\n\t\t_.each(ctrl.getRoutes(), (route) => {\n\t\t\tconst methods = _.isArray(route.method) ? route.method : [route.method || \"get\"];\n\t\t\t_.each(methods, method => {\n\t\t\t\tmethod = _.lowerCase(method);\n\t\t\t\t//console.log(method, route.path);\n\t\t\t\trouter[method](route.path, validate(route.validate), async (ctx, next) => {\n\t\t\t\t\t// 认证中间件\n\t\t\t\t\tif (route.requireAuth && !ctx.state.user) {\n\t\t\t\t\t\tctx.body = ERR_UNATUH;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tctx.state.user = ctx.state.user || {};\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst body = await ctrl[route.action](ctx);\t\n\t\t\t\t\t\tctx.body = body || ctx.body;\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tconsole.log(e);\n\t\t\t\t\t\tctx.status = 500;\n\t\t\t\t\t\tctx.body = \"请求无法处理\";\n\t\t\t\t\t}\n\t\t\t\t\t//console.log(ctx.body);\n\t\t\t\t});\n\t\t\t})\n\t\t\t\n\t\t})\n\t});\n\n\trouter.all(\"/*\", (ctx, next) => {\n\t\tctx.status = 404;\n\t});\n}\n\nexport default registerControllerRouter;\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/index.js","import _ from \"lodash\";\nimport joi from \"joi\";\nimport jwt from \"jwt-simple\";\n\nimport config from \"../config.js\";\nimport {ERR, ERR_OK} from \"../common/error.js\";\nimport userModel from \"../models/user.js\";\n\nexport const User = function() {\n\tthis.model = userModel;\n}\n\nUser.prototype.create = function() {\n\n} \n\nUser.prototype.update = function() {\n\n}\n\nUser.prototype.delete = function() {\n\n}\n\nUser.prototype.find = function() {\n\n}\n\nUser.prototype.register = async function(ctx) {\n\tconst params = ctx.request.body;\n\tlet user = await this.model.findOne({\n\t\twhere: {\n\t\t\tusername: params.username,\n\t\t},\n\t});\n\t\n\tif (user) \treturn ERR.setMessage(\"用户已存在\");\n\n\tuser = await this.model.create({\n\t\tusername: params.username,\n\t\tpassword: params.password,\n\t});\n\n\tif (!user) return ERR;\n\n\treturn ERR_OK.setData({\n\t\ttoken: jwt.encode({\n\t\t\tuserId: user._id, \n\t\t\tusername: user.username\n\t\t}, config.secret),\n\t\tuserinfo: user,\n\t});\n}\n\nUser.prototype.login = async function(ctx) {\n\tconst params = ctx.request.body;\n\tlet user = await this.model.findOne({\n\t\twhere: {\n\t\t\tusername: params.username,\n\t\t\tpassword: params.password,\n\t\t},\n\t});\n\t\n\tif (!user) {\n\t\treturn ERR.setMessage(\"用户名或密码错误\");\n\t}\n\n\tuser = user.get({plain:true});\n\n\n\treturn ERR_OK.setData({\n\t\ttoken: jwt.encode({\n\t\t\tuserId: user._id, \n\t\t\tusername: user.username\n\t\t}, config.secret),\n\t\tuserinfo: user,\n\t});\n}\n\nUser.prototype.isLogin = async function(ctx) {\n\tthis.model.findById(1);\n\treturn \"hello world\";\n}\n\nUser.prototype.getRoutes = function() {\n\tconst self = this;\n\tconst prefix = \"/user\";\n\tconst routes = [\n\t{\n\t\tpath: prefix + \"/register\",\n\t\tmethod: \"post\",\n\t\taction: \"register\",\n\t\tvalidate: {\n\t\t\tbody: {\n\t\t\t\tusername: joi.string().min(4).max(48).required(),\n\t\t\t\tpassword: joi.string().min(4).max(48).required(),\n\t\t\t},\n\t\t}\n\t},\n\n\t{\n\t\tpath: prefix + \"/login\",\n\t\tmethod: \"post\",\n\t\taction: \"login\",\n\t\tvalidate: {\n\t\t\tbody: {\n\t\t\t\tusername: joi.string().min(4).max(48).required(),\n\t\t\t\tpassword: joi.string().min(4).max(48).required(),\n\t\t\t},\n\t\t}\n\t},\n\n\t{\n\t\tpath: prefix + \"/isLogin\",\n\t\tmethod: \"get\",\n\t\taction: \"isLogin\",\n\t},\n\t];\n\n\treturn routes;\n}\n\nexport default new User();\n\n\n\n// WEBPACK FOOTER //\n// ./server/controllers/user.js","import _validate from \"./validate.js\";\n\n\nexport const validate = _validate;\n\nexport default {\n\tvalidate,\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/middlewares/index.js","import _ from 'lodash';\nimport joi from 'joi';\n\nimport {ERR_PARAMS} from \"../common/error.js\";\n\nexport const validate = (schema = {}) => {\n\tconst { opt = {} } = schema;\n\tconst options = _.defaultsDeep(opt, {\n    \tallowUnknown: true,\n  \t});\n  \treturn async (ctx, next) => {\n    \tconst defaultValidateKeys = ['body', 'query', 'params'];\n    \tconst needValidateKeys = _.intersection(defaultValidateKeys, Object.keys(schema));\n\n    \tconst errors = [];\n    \tneedValidateKeys.find((item) => {\n      \t\tconst toValidateObj = item === 'body' ? ctx.request.body : ctx[item];\n      \t\tconst result = joi.validate(toValidateObj, schema[item], options);\n      \t\tif (result.error) {\n        \t\terrors.push(result.error.details[0]);\n        \t\treturn true;\n      \t\t}\n      \t\t_.assignIn(toValidateObj, result.value);\n      \t\treturn false;\n    \t});\n\n    \tif (errors.length !== 0) {\n      \t\tconst msg = errors[0].message.replace(/\"/g, '');\n\t\t\tctx.body = ERR_PARAMS.setMessage(msg);\n\t\t\treturn;\n    \t}\n\n    \tawait next();\n  \t};\n};\n\nexport default validate;\n\n\n\n// WEBPACK FOOTER //\n// ./server/middlewares/validate.js","\nimport _User from \"./user.js\";\nimport _DataSource from \"./dataSource.js\";\n\nexport const User = _User;\nexport const DataSource = _DataSource;\n\nexport default {\n\tUser,\n\tDataSource,\n}\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/index.js","\nexport default {\n\tapiUrlPrefix: \"/api/v0\",\n\tgitlabToken: \"18ayouuEsKRo_yM1P5eF\",\n\n\tsecret: \"keepwork\",\n\n\tdatabase: {\n\t\t//port:3306,\n\t\thost: '39.106.11.114',\n\t\ttype: \"mysql\",\n\t\tdatabase: \"keepwork\", // 数据库名\n\t\tusername: \"wuxiangan\",\n\t\tpassword: \"wuxiangan\", \n\t},\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./server/prod.config.js","module.exports = require(\"@koa/cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"@koa/cors\"\n// module id = 35\n// module chunks = 0","module.exports = require(\"elasticsearch\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"elasticsearch\"\n// module id = 37\n// module chunks = 0","module.exports = require(\"js-base64\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"js-base64\"\n// module id = 39\n// module chunks = 0","module.exports = require(\"js-yaml\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"js-yaml\"\n// module id = 40\n// module chunks = 0","module.exports = require(\"koa-body\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-body\"\n// module id = 41\n// module chunks = 0","module.exports = require(\"koa-jwt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-jwt\"\n// module id = 42\n// module chunks = 0","module.exports = require(\"koa-router\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-router\"\n// module id = 43\n// module chunks = 0","module.exports = require(\"koa-static\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"koa-static\"\n// module id = 44\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 47\n// module chunks = 0","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 48\n// module chunks = 0","module.exports = require(\"webpack\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpack\"\n// module id = 49\n// module chunks = 0","import Koa from 'koa'\nimport { Nuxt, Builder } from 'nuxt'\n\nimport server from \"./server.js\";\nimport _config from \"./config.js\";\n\nasync function start () {\n  const app = new Koa()\n\n  // Import and Set Nuxt.js options\n  let config = require('../nuxt.config.js')\n  config.dev = !(app.env === 'production')\n\n  // Instantiate nuxt.js\n  const nuxt = new Nuxt(config)\n\n  // Build in development\n  if (config.dev) {\n    const builder = new Builder(nuxt)\n    await builder.build()\n  }\n\n  server(app);\n\n  app.use(async (ctx, next) => {\n    await next()\n    ctx.status = 200 // koa defaults to 404 when it sees that status is unset\n    return new Promise((resolve, reject) => {\n      ctx.res.on('close', resolve)\n      ctx.res.on('finish', resolve)\n\t  ctx.req.ctx = ctx;\n      nuxt.render(ctx.req, ctx.res, promise => {\n        // nuxt.render passes a rejected promise into callback on error.\n        promise.then(resolve).catch(reject)\n      })\n    })\n  })\n\n  const host = _config.host || '127.0.0.1'\n  const port = _config.port || 3000\n  app.listen(port, host)\n  console.log('Server listening on ' + host + ':' + port) // eslint-disable-line no-console\n}\n\nstart()\n\n\n\n// WEBPACK FOOTER //\n// ./server/index.js","module.exports = require(\"node-gitlab-api\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"node-gitlab-api\"\n// module id = 51\n// module chunks = 0"],"sourceRoot":""}